# VPS構成の準備 - アカウント作成とドメイン取得

## 🎯 **VPS学習の目的**
- 手動でのサーバー管理を体験
- SSL証明書の手動設定
- データベースの手動セットアップ
- 障害対応とバックアップの重要性を実感

---

## 📋 **必要なアカウント・サービス**

### **1. VPSプロバイダー（推奨順）**

#### **🥇 推奨: さくらのVPS**
- **料金**: 月額580円〜（1GB RAM）
- **特徴**: 日本語サポート、初心者向け
- **URL**: https://vps.sakura.ad.jp/
- **支払い**: クレジットカード、銀行振込

**申し込み手順**:
1. 上記URLにアクセス
2. 「お申し込み」をクリック
3. プラン選択: **1GB（月額580円）**を推奨
4. OS選択: **Ubuntu 22.04 LTS**
5. 会員登録（メールアドレス必要）
6. 支払い情報入力
7. 申し込み完了（通常30分以内に利用開始）

#### **🥈 代替案1: ConoHa VPS**
- **料金**: 月額678円〜（1GB RAM）
- **特徴**: 時間課金対応、高速SSD
- **URL**: https://www.conoha.jp/vps/

#### **🥉 代替案2: Vultr（海外）**
- **料金**: $6/月〜（1GB RAM）
- **特徴**: 世界中にデータセンター
- **URL**: https://www.vultr.com/
- **注意**: 英語のみ、クレジットカード必須

---

### **2. ドメイン取得（必須）**

#### **🥇 推奨: お名前.com**
- **料金**: .com ドメイン 年額1,408円〜
- **特徴**: 日本最大手、管理画面が日本語
- **URL**: https://www.onamae.com/

**取得手順**:
1. 上記URLにアクセス
2. 希望ドメイン名を検索（例: `your-name-infra-test.com`）
3. 利用可能なドメインを選択
4. 会員登録
5. 支払い（クレジットカード推奨）
6. DNS設定は後で行う

#### **🥈 代替案: ムームードメイン**
- **料金**: .com ドメイン 年額1,628円〜
- **URL**: https://muumuu-domain.com/

#### **💡 学習用の安価オプション**
- **.tk/.ml/.ga** ドメイン（Freenom）: 無料
- **注意**: 無料ドメインは制限が多く、学習後は使えなくなる可能性

---

### **3. 費用の目安**

#### **月額費用**
- VPS: 580円〜678円
- ドメイン: 117円（年額1,408円÷12ヶ月）
- **合計**: 約700円〜800円/月

#### **初期費用**
- VPS初期費用: 0円（多くのプロバイダー）
- ドメイン年額: 1,408円
- **合計**: 約1,400円

#### **学習期間の総費用（3ヶ月想定）**
- VPS: 580円 × 3ヶ月 = 1,740円
- ドメイン: 1,408円（年額）
- **合計**: 約3,200円

---

## 🚀 **VPS申し込み後の初期設定**

### **Step 1: VPS接続情報の確認**
VPS申し込み完了後、以下の情報がメールで送られてきます：
- **IPアドレス**: `xxx.xxx.xxx.xxx`
- **ユーザー名**: `root` または `ubuntu`
- **パスワード**: 初期パスワード

### **Step 2: SSH接続の確認**
```bash
# VPSに接続（IPアドレスは実際のものに置き換え）
ssh root@xxx.xxx.xxx.xxx

# 初回接続時は fingerprint の確認が表示される
# "yes" と入力して続行

# パスワードを入力（画面には表示されません）
```

### **Step 3: 基本的なセキュリティ設定**
```bash
# パッケージの更新
apt update && apt upgrade -y

# 新しいユーザーの作成（rootの直接使用を避ける）
adduser deploy
usermod -aG sudo deploy

# SSH鍵の設定（推奨）
# ローカルマシンで鍵を生成
ssh-keygen -t rsa -b 4096 -C "your-email@example.com"

# 公開鍵をVPSにコピー
ssh-copy-id deploy@xxx.xxx.xxx.xxx
```

---

## 🌐 **ドメインのDNS設定**

### **Step 1: ネームサーバーの確認**
ドメイン取得後、DNS設定を行います：

1. **お名前.com管理画面**にログイン
2. **DNS関連機能の設定** → **DNSレコード設定**
3. 対象ドメインを選択

### **Step 2: Aレコードの設定**
```
ホスト名: @ (空欄)
TYPE: A
VALUE: [VPSのIPアドレス]
TTL: 3600

ホスト名: www
TYPE: A  
VALUE: [VPSのIPアドレス]
TTL: 3600
```

### **Step 3: DNS反映の確認**
```bash
# DNS反映確認（反映まで最大48時間）
nslookup your-domain.com
dig your-domain.com

# 反映されると VPS の IP アドレスが表示される
```

---

## ✅ **準備完了チェックリスト**

### **アカウント・サービス**
- [ ] VPSアカウント作成完了
- [ ] VPS利用開始（IPアドレス取得）
- [ ] ドメイン取得完了
- [ ] DNS設定完了

### **接続確認**
- [ ] SSH接続成功
- [ ] sudo権限のユーザー作成
- [ ] ドメインでVPSにアクセス可能

### **次のステップ準備**
- [ ] Docker、Docker Composeインストール準備
- [ ] SSL証明書取得準備（Let's Encrypt）
- [ ] 学習記録ファイルの準備

---

## 🎯 **準備完了後の学習フロー**

1. **Phase 2-1**: Docker環境構築（1日目）
2. **Phase 2-2**: SSL証明書とドメイン設定（2日目）
3. **Phase 2-3**: 運用体験とトラブルシューティング（3日目）

### **学習記録の準備**
```bash
# VPS学習記録セクションを追加
cat >> /home/suda/infra-test/learning-log.md << 'EOF'

## Phase 2: VPS構成体験

### 準備段階
- VPS申し込み日: [日付]
- ドメイン取得日: [日付]  
- 初期費用: [金額]

### アカウント情報（機密情報は別途管理）
- VPSプロバイダー: [プロバイダー名]
- ドメイン: [取得したドメイン]
- VPS IP: [IPアドレス]

### 準備で詰まったポイント
- [問題と解決方法]

---
EOF
```

---

## 💡 **よくある質問**

### **Q: VPSとレンタルサーバーの違いは？**
- **VPS**: 仮想的な専用サーバー、root権限あり、自由度高い
- **レンタルサーバー**: 共有環境、制限あり、管理が簡単

### **Q: ドメインは必須ですか？**
IPアドレスでもアクセス可能ですが、SSL証明書の取得にドメインが必要です。

### **Q: 無料のVPSはありませんか？**
AWS、GCP、Azureに無料枠がありますが、設定が複雑で初心者には推奨しません。

### **Q: 学習後、VPSは解約できますか？**
はい。多くのプロバイダーで月単位での解約が可能です。

---

**準備が完了したら、`docs/phase2-vps.md` の手順に従って実際の構築を開始しましょう！** 